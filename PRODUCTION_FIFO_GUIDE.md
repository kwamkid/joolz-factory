# Production FIFO Costing System - Implementation Guide

## ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß

### 1. Database Schema (SQL Migration)
**‡πÑ‡∏ü‡∏•‡πå:** `sql/update_production_costing.sql`

**‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà:**
- `finished_goods` - ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô

**Columns ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô production_batches:**
- `insufficient_materials` - ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏û‡∏≠ ‡∏ì ‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô
- `total_material_cost` - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏£‡∏ß‡∏° (FIFO)
- `total_bottle_cost` - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏ß‡∏î‡∏£‡∏ß‡∏°
- `unit_cost` - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏Ç‡∏ß‡∏î
- `cost_breakdown` - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ lot

**Functions:**
- `check_material_availability()` - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- `calculate_production_cost_fifo()` - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏ö‡∏ö FIFO

### 2. API Updates

#### POST /api/production (‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô)
```typescript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô
const { data: availabilityCheck } = await supabaseAdmin.rpc('check_material_availability', {
  p_product_id,
  p_total_volume_liters
});

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠
// ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å insufficient_materials
```

**Response:**
```json
{
  "success": true,
  "has_warning": true,
  "insufficient_materials": [
    {
      "material_id": "...",
      "material_name": "‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á",
      "unit": "kg",
      "required": 100,
      "available": 50,
      "shortage": 50
    }
  ],
  "message": "‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°"
}
```

#### PATCH /api/production/[id] (‡πÄ‡∏£‡∏¥‡πà‡∏°/‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï)

**Action: 'start'**
```typescript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
// ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏≠ ‚Üí ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï
if (!check.is_sufficient) {
  return error "‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï"
}
```

**Action: 'complete'**
```typescript
// 1. ‡∏ï‡∏±‡∏î‡∏Ç‡∏ß‡∏î
// 2. ‡∏ï‡∏±‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏° FIFO (deduct_stock_fifo)
// 3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô FIFO (calculate_production_cost_fifo)
// 4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÉ‡∏ô production_batches
// 5. ‡∏™‡∏£‡πâ‡∏≤‡∏á finished_goods
```

**Response:**
```json
{
  "success": true,
  "message": "Production completed successfully",
  "costing": {
    "total_material_cost": 5000,
    "total_bottle_cost": 2000,
    "unit_cost": 14.00,
    "cost_breakdown": [
      {
        "type": "material",
        "material_id": "...",
        "quantity_used": 100,
        "cost": 5000,
        "lots": [
          {"lot_id": "...", "quantity": 50, "unit_cost": 45, "cost": 2250},
          {"lot_id": "...", "quantity": 50, "unit_cost": 55, "cost": 2750}
        ]
      },
      {
        "type": "bottle",
        "bottle_type_id": "...",
        "quantity": 500,
        "unit_price": 4.00,
        "cost": 2000
      }
    ]
  }
}
```

### 3. UI Updates

#### ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï (production/new/page.tsx)
```typescript
// ‡πÅ‡∏™‡∏î‡∏á alert ‡∏´‡∏≤‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠
if (result.has_warning && result.insufficient_materials) {
  alert(`‚ö†Ô∏è ${result.message}

‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î:
- ‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á: ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ 100 kg, ‡∏°‡∏µ 50 kg (‡∏Ç‡∏≤‡∏î 50 kg)
- ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•: ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ 20 kg, ‡∏°‡∏µ 15 kg (‡∏Ç‡∏≤‡∏î 5 kg)

‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï`);
}
```

## üîß ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. Run SQL Migration
```sql
-- ‡πÉ‡∏ô Supabase SQL Editor
-- Copy & Paste ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå: sql/update_production_costing.sql
```

### 2. Workflow ‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï

#### Step 1: ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Production ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÉ‡∏´‡∏°‡πà
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤, ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏ß‡∏î, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
- ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- **‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠:** ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á warning ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÑ‡∏î‡πâ

#### Step 2: ‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏≠)
- ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Stock Management
- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤"
- ‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î + ‡∏£‡∏≤‡∏Ñ‡∏≤

#### Step 3: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Production ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
- ‡∏Å‡∏î "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï"
- **‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏≠:** ‡∏à‡∏∞ error ‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô
- **‡∏ñ‡πâ‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏û‡∏≠:** ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ

#### Step 4: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï
- ‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î)
- ‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á
- ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- **‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞:**
  1. ‡∏ï‡∏±‡∏î‡∏Ç‡∏ß‡∏î‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏™‡∏ï‡πá‡∏≠‡∏Å
  2. ‡∏ï‡∏±‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÅ‡∏ö‡∏ö FIFO (lot ‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô)
  3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô FIFO
  4. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢‡πÉ‡∏ô `finished_goods`

## üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏™‡∏£‡πá‡∏à

### Production Batch
```sql
SELECT
  batch_id,
  status,
  total_material_cost,  -- 5,000 ‡∏ö‡∏≤‡∏ó
  total_bottle_cost,     -- 2,000 ‡∏ö‡∏≤‡∏ó
  unit_cost,             -- 14.00 ‡∏ö‡∏≤‡∏ó/‡∏Ç‡∏ß‡∏î
  cost_breakdown         -- JSON ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î FIFO
FROM production_batches
WHERE id = '...';
```

### Finished Goods (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢)
```sql
SELECT
  fg.product_id,
  fg.bottle_type_id,
  fg.quantity,           -- 500 ‡∏Ç‡∏ß‡∏î
  fg.unit_cost,          -- 14.00 ‡∏ö‡∏≤‡∏ó/‡∏Ç‡∏ß‡∏î
  fg.total_cost,         -- 7,000 ‡∏ö‡∏≤‡∏ó (500 √ó 14)
  fg.manufactured_date
FROM finished_goods fg
WHERE production_batch_id = '...';
```

### Cost Breakdown (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô FIFO)
```json
{
  "cost_breakdown": [
    {
      "type": "material",
      "material_id": "orange-juice",
      "quantity_used": 100,
      "cost": 5000,
      "lots": [
        {
          "lot_id": "lot-1",
          "quantity": 50,
          "unit_cost": 45.00,
          "cost": 2250
        },
        {
          "lot_id": "lot-2",
          "quantity": 50,
          "unit_cost": 55.00,
          "cost": 2750
        }
      ]
    },
    {
      "type": "bottle",
      "bottle_type_id": "bottle-500ml",
      "quantity": 500,
      "unit_price": 4.00,
      "cost": 2000
    }
  ]
}
```

## üéØ ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö

1. **‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ** - ‡πÅ‡∏°‡πâ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏Å‡πá‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÑ‡∏î‡πâ (planning ahead)
2. **‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö** - ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà
3. **‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ú‡∏•‡∏¥‡∏ï‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î** - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏û‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
4. **‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏î‡πâ‡∏ß‡∏¢ FIFO** - ‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å lot ‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏≤
5. **‡∏£‡∏π‡πâ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏Ç‡∏ß‡∏î** - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
6. **‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤ finished_goods ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô

## üîç Example Scenario

### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏ú‡∏•‡∏¥‡∏ï‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏° 500 ‡∏Ç‡∏ß‡∏î

1. **‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô:**
   - ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï: ‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏° 500ml ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 500 ‡∏Ç‡∏ß‡∏î
   - ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö: ‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á 100 kg
   - ‡∏°‡∏µ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å: 50 kg
   - **Warning:** ‡∏Ç‡∏≤‡∏î 50 kg

2. **‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°:**
   - ‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡πâ‡∏° 50 kg ‡∏£‡∏≤‡∏Ñ‡∏≤ 2,750 ‡∏ö‡∏≤‡∏ó (55 ‡∏ö‡∏≤‡∏ó/kg)
   - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å lot ‡πÉ‡∏´‡∏°‡πà

3. **‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï:**
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏™‡πâ‡∏° 100 kg ‚úì
   - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ

4. **‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏™‡∏£‡πá‡∏à:**
   - ‡∏ú‡∏•‡∏¥‡∏ï‡πÑ‡∏î‡πâ: 500 ‡∏Ç‡∏ß‡∏î (‡∏Ç‡∏≠‡∏á‡∏î‡∏µ 495, ‡πÄ‡∏™‡∏µ‡∏¢ 5)
   - ‡πÉ‡∏ä‡πâ‡∏™‡πâ‡∏°‡∏à‡∏£‡∏¥‡∏á: 100 kg
   - **‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡∏î FIFO:**
     - Lot 1 (‡πÄ‡∏Å‡πà‡∏≤): 50 kg @ 45 ‡∏ö‡∏≤‡∏ó/kg = 2,250 ‡∏ö‡∏≤‡∏ó
     - Lot 2 (‡πÉ‡∏´‡∏°‡πà): 50 kg @ 55 ‡∏ö‡∏≤‡∏ó/kg = 2,750 ‡∏ö‡∏≤‡∏ó
   - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö: 5,000 ‡∏ö‡∏≤‡∏ó
   - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏ß‡∏î: 500 ‡∏Ç‡∏ß‡∏î @ 4 ‡∏ö‡∏≤‡∏ó = 2,000 ‡∏ö‡∏≤‡∏ó
   - **‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°: 7,000 ‡∏ö‡∏≤‡∏ó**
   - **‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏Ç‡∏ß‡∏î: 14.00 ‡∏ö‡∏≤‡∏ó**

5. **Finished Goods:**
   - ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢: 495 ‡∏Ç‡∏ß‡∏î
   - ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô: 495 √ó 14 = 6,930 ‡∏ö‡∏≤‡∏ó

## üìù TODO ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö UI (‡∏ó‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ)

### ‡∏´‡∏ô‡πâ‡∏≤ Production Detail ([id]/page.tsx)
- [ ] ‡πÅ‡∏™‡∏î‡∏á warning badge ‡∏ñ‡πâ‡∏≤ insufficient_materials ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
- [ ] ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏™‡∏£‡πá‡∏à:
  - Total Material Cost
  - Total Bottle Cost
  - Unit Cost
  - Cost Breakdown (expandable)
- [ ] ‡πÅ‡∏™‡∏î‡∏á Finished Goods ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï

### ‡∏´‡∏ô‡πâ‡∏≤ Production List (page.tsx)
- [ ] ‡πÅ‡∏™‡∏î‡∏á badge "‚ö†Ô∏è ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ insufficient_materials
- [ ] ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß)

## üöÄ Next Steps

1. **Run SQL Migration** - ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
2. **Test Workflow:**
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‚Üí ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÑ‡∏°‡πà‡∏û‡∏≠
   - ‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°
   - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï ‚Üí ‡∏ú‡πà‡∏≤‡∏ô
   - ‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏™‡∏£‡πá‡∏à ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô
3. **Check Finished Goods** - ‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢

---

**Created:** 2025-01-27
**‡∏£‡∏∞‡∏ö‡∏ö:** FIFO Costing for Production
**Database:** PostgreSQL (Supabase)
